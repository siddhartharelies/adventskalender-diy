<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Tür 1</title>
</head>
<body>
  <h1>Tür 1</h1>
  <p>Gib das Passwort ein (die Lösung aus der Mail):</p>

  <form id="pwForm">
    <input type="password" id="password" placeholder="Passwort">
    <button type="submit">Öffnen</button>
  </form>

  <p id="message"></p>

  <div id="secret-content" style="display:none; margin-top:20px;"></div>

  <p><a href="index.html">Zurück zur Übersicht</a></p>

  <script>
    document.getElementById("pwForm").addEventListener("submit", async function (event) {
      event.preventDefault();

      const pw = document.getElementById("password").value;

      const response = await fetch("/.netlify/functions/checkDoor1", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          password: pw,
          mode: "open"   // hier wirklich Tür öffnen
        })
      });

      const data = await response.json();

      const msg = document.getElementById("message");
      const contentDiv = document.getElementById("secret-content");

      if (data.success) {
        msg.textContent = "Richtig! Tür 1 öffnet sich.";
        contentDiv.innerHTML = data.contentHtml;
        contentDiv.style.display = "block";
      } else {
        msg.textContent = "Falsches Passwort, versuche es noch einmal.";
        contentDiv.style.display = "none";
        contentDiv.innerHTML = "";
      }
    });
  </script>
</body>
</html>
